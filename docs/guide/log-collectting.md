# 日志收集

## 介绍

Corejs提供[日志输出器](#日志输出器)和[日志输出组](#日志输出组)进行单点/多点日志收集。日志输出组必须依赖Corejs核心组件LoggerCore使用。

::: tip 说明
**[日志输出组](#日志输出组)内可以嵌入一个或多个[日志输出器](#日志输出器)以实现多个日志输出器组合使用，其本质上是一种特殊类型的日志输出器**。日志输出组统一管理嵌于其中的日志输出器生命周期，输出日志时执行每个日志输出器的```log()```实现多点输出。
:::

日志输出器和日志输出组有相同的生命周期控制和输出API，即：

- 使用```start()```启动输出器/组，此时将初始化资源（如：文件句柄等）并将输出器/组置为启动状态。
- 使用```close()```关闭输出器/组，此时将释放初始化过程中创建的资源（如：文件句柄等）并将输出器/组置为关闭状态。
- 使用```log()```输出日志，仅允许在输出器/组启动状态下调用，否则将输出警告。

::: tip 关于LoggerCore、日志输出组、日志输出器的关系
LoggerCore是生产[日志输出组](#日志输出组)的工厂，而每个日志输出组可以嵌入一个或多个[日志输出器](#日志输出器)。**日志输出组无法直接使用**，LoggerCore执行```createLogger()```时将根据传入输出组类型自动创建输出组实例，同时创建LoggerCore输出器配置列表中指定数量和种类的输出器实例植入先前创建的输出组实例中。即：多点日志场景下，日志输出组仅作为日志输出器的运行容器。

**在LoggerCore层面上可以配置日志输出器的基础配置参数，在配置输出器列表时可以进行个性化配置，优先级更高**。LoggerCore在创建输出器实例时，将迭代输出器配置列表，将个性化配置合并至基础配置中得到最终输出器配置。
:::

## 输出器模型

[输出器模型](/images/test.png)

## 日志输出器

日志输出器可以直接使用，也可以通过LoggerCore植入日志输出组中使用。[自定义输出器](/guide/logger-customizing.html)必须继承[基础输出器](/guide/logger-introduce.html#基础输出器)。推荐学习路线为：

- 先学习[基础输出器](/guide/logger-introduce.html#基础输出器)了解日志输出器的基础配置、生命周期、输出模型。
- 再学习[日期输出器](/guide/logger-introduce.html#日期输出器)和[文件输出器](/guide/logger-introduce.html#文件输出器)的基本使用
- 最后学习[自定义输出器](/guide/logger-customizing.html)

日志输出器有三个核心API：

- 使用```start()```启动日志输出器
- 使用```log()```进行日志输出
- 使用```close()```关闭日志输出器

::: warning 注意
一般情况下，**日志输出器仅允许在启动状态下输出日志**（可通过私有配置修改行为），即执行```start()```启动输出器。一些支持自启动的日志输出器实例化后自动执行```start()```，无须再显式执行。
:::

Corejs内置了多种日志输出器：

- [基础输出器](/guide/logger-introduce.html#基础输出器)
- [日期输出器](/guide/logger-introduce.html#日期输出器)
- [文件输出器](/guide/logger-introduce.html#文件输出器)

## 日期输出组

日志输出组必须配合LoggerCore使用，可以嵌入一个或多个[日志输出器](#日志输出器)。在LoggerCore执行```createLogger()```时，传入日志输出组将指定创建输出组实例的类型，否则将创建[基础输出组](/)的实例。可以使用LoggerCore和输出组使业务与日志收集结合，推荐学习路线为（需要对日志输出器有中等水平了解）：

- 先学习LoggerCore的使用方法，包括行为触发器、配置合并原理等。
- 再学习LoggerCore与日志输出组联动原理。
- 最后学习[自定义输出组](/guide/logger-group-customizing.html)
